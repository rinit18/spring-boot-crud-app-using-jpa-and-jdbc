<script>
    // âœ… URL has been updated to your backend
    const API_URL = "https://spring-boot-crud-app-using-jpa-and-jdbc-production.up.railway.app/students";

    async function fetchStudents() {
        try {
            const response = await fetch(API_URL);
            const data = await response.json();

            const tbody = document.getElementById("studentBody");
            tbody.innerHTML = "";

            if (data.length === 0) {
                tbody.innerHTML = "<tr><td colspan='4'>No students found</td></tr>";
                return;
            }

            data.forEach(student => {
                const row = `
                        <tr>
                            <td>${student.id}</td>
                            <td>${student.name}</td>
                            <td>${student.marks}</td>
                            <td>
                                <button class="delete" onclick="deleteStudent(${student.id})">Delete</button>
                            </td>
                        </tr>`;
                tbody.innerHTML += row;
            });
        } catch (error) {
            document.getElementById("studentBody").innerHTML =
                `<tr><td colspan='4' style='color:red;'>Couldn't load student data</td></tr>`;
            console.error("Error:", error);
        }
    }

    async function addStudent(event) {
        event.preventDefault();
        const name = document.getElementById("name").value;
        const marks = document.getElementById("marks").value;

        await fetch(API_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, marks })
        });

        document.getElementById("studentForm").reset();
        fetchStudents();
    }

    async function deleteStudent(id) {
        await fetch(`${API_URL}/${id}`, { method: "DELETE" });
        fetchStudents();
    }

    document.getElementById("studentForm").addEventListener("submit", addStudent);
    fetchStudents();
</script>